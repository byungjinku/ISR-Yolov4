# ISR-Yolov4

Wearing a hard hat can effectively improve the safety of workers on a construction site. However, workers often take off their helmets because they have a weak sense of safety and are uncomfortable, and this action poses a large danger. Workers not wearing hard hats are more likely to be injured in accidents such as human falls and vertical falls. Therefore, detection of wearing a helmet is an important step in safety management of a construction site, and it is urgent to detect helmets quickly and accurately. However, the existing manual monitor is labor intensive, and it is difficult to popularize the method of mounting the sensor on the helmet. Thus, in this paper, we propose an AI method to detect wearing a helmet with satisfactory accuracy with a high detection rate. Our method selects based on YOLO v4 and adds an Image Super Resolution (ISR) module at the end of the input. Afterward, the image resolution as well as the noise in the image are removed. Then, dense blocks are used to replace residual blocks in the backbone network using the CSPDarknet53 framework to reduce unnecessary computation and reduce the number of network structure parameters. The neck then uses a combination of SPPnet and PANnet to take full advantage of the small targetâ€™s capabilities in the image. We add foreground and background balance loss functions to the YOLOv4 loss function part to solve the image background and foreground imbalance problem. Experiments performed using self-constructed data sets show that the proposed method has more efficacy than the currently available small target detection methods. Finally, our model achieves an average precision of 93.3\( \% \)., a 7.8\( \% \). increase over the original algorithm, and it takes only 3.0ms to detect an image at 416 416.
![test image 1](https://user-images.githubusercontent.com/66653030/179683261-12a176c5-8628-41d0-b7be-d23f1ae12207.png)
![test image 6](https://user-images.githubusercontent.com/66653030/179683302-c4366bf5-23f1-47cf-8ad8-41db8fe296c8.png)
